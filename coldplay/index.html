
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Visualitzador d'àudio</title>
    <style>
        
body {
    font-family: 'Arial', sans-serif;
    color: #444;
    line-height: 1.6;
    background-color: #f0f2f5;
}

header {
    background-color: #003366;
    color: #fff;
    padding: 1.5rem 0;
    text-align: center;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

header h1 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

nav ul {
    list-style: none;
    display: flex;
    justify-content: center;
    gap: 2rem;
}

nav ul li a {
    color: #fff;
    text-decoration: none;
    font-weight: bold;
    padding: 0.5rem 1rem;
    transition: color 0.3s, background-color 0.3s;
}

nav ul li a:hover {
    color: #003366;
    background-color: #fff;
    border-radius: 5px;
}

main {
    max-width: 800px;
    margin: 2rem auto;
    padding: 1.5rem;
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

main section {
    margin-bottom: 2rem;
}

main section h2 {
    color: #003366;
    margin-bottom: 1rem;
    font-size: 1.8rem;
}

button {
    background-color: #003366;
    color: #fff;
    border: none;
    padding: 0.7rem 1.5rem;
    font-size: 1rem;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s;
    border-radius: 5px;
}

button:hover {
    background-color: #005cbf;
}

footer {
    background-color: #003366;
    color: #fff;
    text-align: center;
    padding: 1rem;
    font-size: 0.9rem;
    position: fixed;
    bottom: 0;
    width: 100%;
}

    </style>
</head>
<body>
    <h1>SVG Visualitzador d'àudio</h1>
    <div class="controls">
        <label for="songSelect">Selecciona cançó:</label>
        <select id="songSelect">
            <option value="song1">Song 1</option>
            <option value="song2">Song 2</option>
            <!-- Easily add more songs here -->
        </select>
        <br><br>
        <input type="file" id="audioFile" accept="audio/*">
        <br><br>
        <audio id="audioPlayer" controls></audio>
    </div>

    <svg id="svgVisualizer" width="400" height="400" viewBox="0 0 100 100">
        
        <g id="corona" style="display:none;" fill="hsl(200, 100%, 50%)">
            <path d="M 30.061445 49.616875 C 30.061445 45.134375 26.66418 41.490625 22.474219 41.490625 C 18.284258 41.490625 14.886992 45.134375 14.886992 49.616875 C 14.886992 54.10625 18.284258 57.743125 22.474219 57.743125 C 26.66418 57.743125 30.061445 54.10625 30.061445 49.616875 Z M 30.061445 49.616875 " transform="matrix(0.44843,0,0,0.568182,0,0)"/>
            <path d="M 74.016836 35.701875 C 74.016836 31.356875 70.602148 27.836875 66.386055 27.836875 C 62.178672 27.836875 58.755273 31.356875 58.755273 35.701875 C 58.755273 40.046875 62.178672 43.566875 66.386055 43.566875 C 70.602148 43.566875 74.016836 40.046875 74.016836 35.701875 Z M 74.016836 35.701875 " transform="matrix(0.44843,0,0,0.568182,0,0)"/>
            <path d="M 118.869453 48.13875 C 118.869453 44.034375 115.620273 40.706875 111.613242 40.706875 C 107.606211 40.706875 104.365742 44.034375 104.365742 48.13875 C 104.365742 52.23625 107.606211 55.56375 111.613242 55.56375 C 115.620273 55.56375 118.869453 52.23625 118.869453 48.13875 Z M 118.869453 48.13875 " transform="matrix(0.44843,0,0,0.568182,0,0)"/>
            <path d="M 161.962461 35.701875 C 161.962461 31.549375 158.60875 28.180625 154.479766 28.180625 C 150.34207 28.180625 146.988359 31.549375 146.988359 35.701875 C 146.988359 39.854375 150.34207 43.223125 154.479766 43.223125 C 158.60875 43.223125 161.962461 39.854375 161.962461 35.701875 Z M 161.962461 35.701875 " transform="matrix(0.44843,0,0,0.568182,0,0)"/>
            <path d="M 207.215781 49.8025 C 207.215781 45.7325 203.835938 42.439375 199.663398 42.439375 C 195.49957 42.439375 192.119727 45.7325 192.119727 49.8025 C 192.119727 53.8725 195.49957 57.1725 199.663398 57.1725 C 203.835938 57.1725 207.215781 53.8725 207.215781 49.8025 Z M 207.215781 49.8025 " transform="matrix(0.44843,0,0,0.568182,0,0)"/>
            <path d="M 24.939414 58.925625 L 44.007656 132.0275 C 44.007656 132.0275 44.443203 134.5575 44.007656 135.69875 C 43.650508 136.640625 41.856055 136.970625 42.012852 137.9675 C 42.221914 139.294375 45.471094 140.036875 45.471094 140.036875 C 45.471094 140.036875 45.941484 144.354375 45.471094 146.4375 C 45.174922 147.74375 43.589531 148.73375 43.737617 150.0675 C 43.894414 151.45625 46.333477 153.35375 46.333477 153.35375 L 176.692656 153.525625 C 176.692656 153.525625 179.105586 151.476875 179.114297 150.0675 C 179.123008 148.740625 177.276289 148.04625 176.866875 146.78125 C 176.17 144.643125 176.692656 140.036875 176.692656 140.036875 C 176.692656 140.036875 179.671797 140.834375 180.499336 139.865 C 181.170078 139.074375 180.847773 137.534375 180.150898 136.7575 C 179.79375 136.35875 178.591641 136.406875 178.591641 136.406875 L 178.591641 132.433125 L 197.607617 57.2275 L 175.656055 82.29375 L 155.603477 43.910625 L 153.347344 44.089375 L 132.258164 83.675625 L 112.719531 56.533125 L 109.958164 56.533125 L 90.59375 84.37 L 67.771094 44.433125 L 64.835508 44.433125 L 47.544297 84.71375 L 26.455117 57.915 Z M 24.939414 58.925625 " transform="matrix(0.44843,0,0,0.568182,0,0)"/>
            <path d="M 44.007656 132.763125 L 178.731016 133.010625 Z M 44.007656 132.763125 " transform="matrix(0.44843,0,0,0.568182,0,0)"/>
            <path d="M 43.032031 136.186875 L 179.462734 136.186875 Z M 43.032031 136.186875 " transform="matrix(0.44843,0,0,0.568182,0,0)"/>
            <path d="M 44.739375 140.09875 L 177.258867 140.34625 Z M 44.739375 140.09875 " transform="matrix(0.44843,0,0,0.568182,0,0)"/>
            <path d="M 45.235898 146.69875 L 177.511484 146.69875 Z M 45.235898 146.69875 " transform="matrix(0.44843,0,0,0.568182,0,0)"/>
            </g>

        <g id="vida">
            <path d="M 833.227773 603.818359 L 577.675156 526.562695 C 577.675156 526.562695 626.964492 543.200195 650.074258 554.945703 C 676.495273 568.369141 725.060273 602.613086 725.060273 602.613086 C 725.060273 602.613086 676.59875 567.77832 650.10875 554.283984 C 634.173359 546.17793 617.134219 539.395312 600.095078 533.817969 C 592.506797 531.336523 585.642852 526.231836 577.675156 526.255469 C 561.912227 526.326367 550.012422 536.417578 535.560195 543.649219 C 496.411563 563.264453 457.331914 593.963477 414.837539 590.725781 C 392.866016 589.071484 357.752969 557.450781 357.752969 557.450781 C 357.752969 557.450781 335.884922 550.455469 325.330312 545.941602 C 315.741484 541.853125 306.083672 537.670117 297.391641 531.903711 C 287.181953 525.168359 277.731094 518.267578 268.383711 510.208789 C 262.968437 505.529492 255.794062 501.039258 253.172656 494.469336 C 251.861953 491.137109 254.345391 483.763672 254.345391 483.763672 C 254.345391 483.763672 236.823359 466.60625 230.718242 456.113281 C 227.855391 451.174023 223.509375 443.091602 221.646797 436.899805 C 220.370586 432.74043 221.094922 429.077344 221.094922 429.077344 L 228.303789 425.60332 L 213.886055 408.729492 C 213.886055 408.729492 202.158711 396.605859 204.159258 391.359375 C 206.608203 384.883984 219.991172 389.185156 223.164453 383.016992 C 225.751367 377.983203 222.267656 368.45918 222.267656 368.45918 C 222.267656 368.45918 230.856211 360.778516 236.2025 360.471289 C 241.928203 360.14043 251.999922 367.277539 251.999922 367.277539 L 250.792695 374.414648 C 250.792695 374.414648 261.554258 377.652344 266.417656 380.346484 C 271.591484 383.206055 280.524961 391.052148 280.524961 391.052148 C 280.524961 391.052148 280.007578 397.905664 278.45543 400.883398 C 276.799805 404.121094 271.005117 408.871289 271.005117 408.871289 C 271.005117 408.871289 269.590937 413.148828 271.246562 415.110352 C 274.109414 418.537109 282.697969 422.791016 287.457891 427.186719 C 293.700977 432.976758 295.977461 438.601367 295.977461 438.601367 C 295.977461 438.601367 297.322656 441.697266 304.772969 438.081445 C 314.982656 433.094922 327.572305 420.994922 346.543008 415.630273 C 355.269531 413.172461 365.686172 412.558008 375.895859 409.154883 C 400.937187 400.765234 427.427188 388.523438 444.81125 385.451172 C 456.573086 383.347852 474.750469 378.195898 490.065 376.517969 C 499.274414 375.501758 510.104961 371.082422 519.141914 371.31875 C 531.938516 371.649609 543.941797 376.187109 554.116992 378.408594 C 572.466836 382.449805 574.777812 382.048047 584.780547 385.09668 C 598.163516 389.208789 614.374844 390.603125 627.171445 396.322266 C 641.692656 402.821289 654.52375 411.140039 669.66582 415.866602 C 739.133086 437.561523 880.758008 467.126172 880.758008 467.126172 L 883.413906 604.40918 Z M 833.227773 603.818359 " transform="matrix(0.11325,0,0,0.165289,0,0)"/>
            <path d="M 587.50543 384.93125 C 587.50543 384.93125 566.568672 381.339063 546.114805 376.376172 C 535.215273 373.705664 525.212539 369.026367 516.899922 370.208008 C 482.821641 374.981836 448.294961 381.575391 415.182461 392.49375 C 401.592539 396.983984 375.688906 409.320312 375.688906 409.320312 C 375.688906 409.320312 338.954727 416.079297 324.640469 427.021289 C 313.361523 435.647266 295.942969 438.412305 290.803633 451.339453 C 287.526875 459.563672 289.148008 471.616406 295.839492 477.382812 C 300.047539 480.998633 305.290352 479.62793 310.981562 479.651563 C 320.190977 479.698828 330.538633 479.273438 339.541094 479.060742 C 349.681797 478.848047 369.790742 476.555664 369.790742 476.555664 L 428.634414 459.729102 L 455.53832 464.786523 " transform="matrix(0.11325,0,0,0.165289,0,0)"/>
            <path d="M 374.412695 550.313672 C 374.412695 550.313672 303.807187 518.125781 281.111328 488.513867 C 265.417383 468.047852 254.483359 438.223242 248.102305 412.250781 C 245.377422 401.001562 240.376055 389.870508 243.031953 381.268164 C 243.61832 379.306641 241.824727 377.912305 243.652813 376.187109 C 253.310625 367.301172 282.008125 391.430273 282.008125 391.430273 C 282.008125 391.430273 280.766406 396.464063 277.558633 401.001562 C 274.626797 405.090039 269.659922 408.516797 270.073828 412.274414 C 270.694687 417.61543 279.55918 420.451367 284.698516 425.485156 C 292.597227 433.213086 297.736562 442.169922 297.736562 442.169922 " transform="matrix(0.11325,0,0,0.165289,0,0)"/>
            <path d="M 294.183867 514.958984 C 294.183867 514.958984 269.487461 485.370703 260.898906 468.307813 C 252.655273 451.953906 243.963242 416.008398 243.963242 416.008398 C 243.963242 416.008398 240.272578 405.444531 238.134062 396.676758 C 236.99582 392.044727 234.374414 388.216211 237.133789 385.994727 C 238.582461 384.836719 242.169648 388.381641 242.169648 388.381641 " transform="matrix(0.11325,0,0,0.165289,0,0)"/>
            <path d="M 401.45457 326.558203 L 405.904063 326.558203 L 405.904063 257.928516 C 405.904063 257.928516 420.287305 250.436914 424.840273 244.079688 C 427.772109 239.991211 429.393242 229.687305 429.393242 229.687305 C 429.393242 229.687305 428.427461 222.266602 424.426367 216.594727 C 422.011914 213.167969 415.492891 211.962695 416.010273 208.89043 C 416.734609 204.471094 421.218594 204.116602 425.116211 201.658789 C 432.049141 197.286719 440.327266 191.92207 445.294141 185.706641 C 453.64125 175.237305 462.678203 149.477539 462.678203 149.477539 C 462.678203 149.477539 439.913359 157.701758 430.083086 164.508008 C 420.425273 171.196094 405.007266 189.275195 405.007266 189.275195 L 404.420898 183.93418 C 404.420898 183.93418 418.286758 157.252734 418.804141 142.718555 C 419.011094 136.29043 420.770195 125.230273 418.183281 117.644141 C 415.699844 110.530664 408.870391 106.678516 408.870391 106.678516 L 393.72832 121.236328 L 386.00207 115.895313 C 386.00207 115.895313 382.621836 120.83457 382.035469 127.120898 C 381.483594 132.910937 383.656602 139.858984 384.380938 144.372852 C 386.484961 157.819922 399.074609 182.445312 399.074609 182.445312 C 399.074609 182.445312 386.036563 163.751758 377.068594 156.992773 C 368.376562 150.422852 347.37082 143.238477 347.37082 143.238477 C 347.37082 143.238477 342.541914 168.147461 353.337969 183.60332 C 358.097891 190.433203 367.514258 195.963281 375.240508 199.508203 C 380.48332 201.895117 385.657148 202.013281 385.415703 206.219922 C 385.105273 211.58457 376.620195 213.735156 375.58543 219.005273 C 374.792109 223.25918 379.172617 231.483398 379.172617 231.483398 L 349.750781 228.812891 L 399.074609 257.030469 Z M 401.45457 326.558203 " transform="matrix(0.11325,0,0,0.165289,0,0)"/>
            <path d="M 246.722617 363.543555 C 246.722617 363.543555 262.451055 367.277539 270.453242 365.126953 C 277.627617 363.189062 288.458164 353.405078 288.458164 353.405078 C 288.458164 353.405078 300.978828 358.4625 307.428867 357.682617 C 312.154297 357.139062 317.811016 352.57793 322.915859 349.600195 C 327.641289 346.858789 331.952812 345.653516 331.952812 345.653516 L 352.682617 343.313867 L 371.273906 334.333398 C 371.273906 334.333398 380.966211 336.176758 385.622656 335.136914 C 391.106914 333.931641 400.488789 327.172656 400.488789 327.172656 L 417.183008 320.626367 L 431.083359 321.808008 L 436.084727 330.197656 L 445.190664 327.172656 C 445.190664 327.172656 454.124141 334.451562 459.711875 337.051172 C 466.644805 340.288867 480.959063 342.084961 480.959063 342.084961 L 495.825195 372.476758 C 495.825195 372.476758 453.64125 380.748242 433.083906 386.987305 C 413.423359 392.942773 375.447461 408.824023 375.447461 408.824023 C 375.447461 408.824023 349.681797 414.070508 337.575039 419.080664 C 324.364531 424.539844 300.357969 440.421094 300.357969 440.421094 C 300.357969 440.421094 292.769687 432.693164 284.043164 425.0125 C 279.007305 420.569531 271.315547 417.402734 270.41875 412.463477 C 269.797891 409.13125 274.937227 406.767969 277.248203 402.844922 C 280.249023 397.834766 280.697422 391.548437 280.697422 391.548437 L 269.108047 381.90625 L 251.482539 373.658398 Z M 246.722617 363.543555 " transform="matrix(0.11325,0,0,0.165289,0,0)"/>
            <path d="M 619.20375 539.749805 L 725.991562 604.740039 L 832.813867 604.740039 Z M 619.20375 539.749805 " transform="matrix(0.11325,0,0,0.165289,0,0)"/>
            </g>

        <g id="nota_musical" clip-path="url(#clip2)">
            <path d="M 747.421875 1621.171875 C 747.421875 1615.859375 746.171875 1611.484375 744.609375 1611.484375 C 743.046875 1611.484375 741.875 1615.859375 741.875 1621.171875 C 741.875 1626.5625 743.046875 1630.9375 744.609375 1630.9375 C 746.171875 1630.9375 747.421875 1626.5625 747.421875 1621.171875 Z M 747.421875 1621.171875 " transform="matrix(0.05,0,0,0.05,0,0)"/>
            <path d="M 306.484375 1435.546875 C 306.484375 1435.546875 347.265625 1395.3125 397.578125 1366.875 C 431.40625 1347.734375 470.859375 1337.96875 497.96875 1332.8125 C 525.859375 1327.578125 571.328125 1320.703125 609.84375 1327.109375 C 661.953125 1335.625 704.6875 1359.375 704.6875 1359.375 L 750.46875 424.375 L 1664.0625 328.125 L 1611.015625 1379.140625 C 1611.015625 1379.140625 1597.578125 1429.6875 1558.59375 1472.5 C 1528.515625 1505.546875 1476.640625 1531.09375 1445.078125 1543.4375 C 1410.46875 1556.953125 1338.125 1570.078125 1289.140625 1566.09375 C 1222.734375 1560.625 1182.734375 1534.375 1182.734375 1534.375 C 1182.734375 1534.375 1155.78125 1521.25 1135.46875 1496.25 C 1121.484375 1478.984375 1112.578125 1452.265625 1110.15625 1435.78125 C 1104.765625 1397.96875 1149.296875 1328.125 1149.296875 1328.125 C 1149.296875 1328.125 1184.140625 1292.578125 1229.296875 1265 C 1263.75 1243.984375 1305.3125 1230.234375 1335.46875 1224.53125 C 1369.53125 1218.125 1425.234375 1217.5 1468.75 1226.015625 C 1514.921875 1235 1548.125 1253.4375 1548.125 1253.4375 L 1589.375 453.828125 L 813.359375 556.015625 L 805.46875 675.859375 L 1583.515625 577.578125 L 1575.625 707.265625 L 799.609375 797.65625 L 805.46875 673.90625 L 766.171875 1477.421875 C 766.171875 1477.421875 759.53125 1516.09375 735.078125 1551.484375 C 726.328125 1564.21875 714.296875 1572.109375 702.96875 1584.609375 C 668.59375 1622.34375 615.390625 1647.8125 579.453125 1658.59375 C 555.546875 1665.859375 520.234375 1675 486.015625 1673.515625 C 480.46875 1673.203125 474.921875 1675.390625 469.453125 1674.53125 C 467.5 1674.21875 465.546875 1674.921875 463.59375 1674.609375 C 462.109375 1674.296875 460.703125 1674.609375 459.21875 1674.296875 C 458.125 1674.140625 457.1875 1674.296875 456.171875 1674.21875 C 445.78125 1673.59375 435.15625 1674.0625 425 1672.265625 C 422.03125 1671.71875 407.1875 1668.90625 404.140625 1669.0625 C 393.125 1669.609375 383.828125 1664.296875 375.859375 1661.5625 C 365.625 1657.96875 357.421875 1656.25 348.59375 1651.875 C 312.03125 1633.75 292.734375 1607.109375 292.734375 1607.109375 C 292.734375 1607.109375 280.078125 1594.921875 272.578125 1575.078125 C 266.5625 1559.140625 265.3125 1536.71875 266.09375 1523.359375 C 268.046875 1491.328125 306.484375 1435.546875 306.484375 1435.546875 Z M 306.484375 1435.546875 " transform="matrix(0.05,0,0,0.05,0,0)"/>
        </g>
    </svg>

    <script>
        const fileInput = document.getElementById('audioFile');
        const audioPlayer = document.getElementById('audioPlayer');
        const songSelect = document.getElementById('songSelect');
        const shapes = {
            corona: document.getElementById('corona'),
            vida: document.getElementById('vida'),
            nota_musical: document.getElementById('nota_musical')


        };

        let audioContext, analyser, frequencyData;
        let currentShapeIndex = 0;
        let cycleInterval;

        // Configuration for each song (easily scalable)
        const songConfig = {
            song1: {
                shapeOrder: ['corona', 'vida', 'nota_musical'],
                durations: [5000, 5000, 5000]
            },
            
        };

        fileInput.addEventListener('change', handleFileUpload);
        songSelect.addEventListener('change', resetVisualizer);

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('audio/')) {
                const audioURL = URL.createObjectURL(file);
                audioPlayer.src = audioURL;
                audioPlayer.load();
                initAudio();
            } else {
                alert('Please upload a valid audio file.');
            }
        }

        function initAudio() {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            analyser = audioContext.createAnalyser();
            analyser.fftSize = 256;
            frequencyData = new Uint8Array(analyser.frequencyBinCount);

            const source = audioContext.createMediaElementSource(audioPlayer);
            source.connect(analyser);
            analyser.connect(audioContext.destination);

            visualize();
            startCycleShapes();
        }

        function visualize() {
            requestAnimationFrame(visualize);
            analyser.getByteFrequencyData(frequencyData);

            const averageFrequency = frequencyData.reduce((a, b) => a + b) / frequencyData.length;
            const scale = averageFrequency / 255;

            const selectedShape = shapes[getCurrentShape()];
            const hue = Math.round((averageFrequency / 255) * 360);
            selectedShape.setAttribute('fill', `hsl(${hue}, 100%, 50%)`);
            selectedShape.setAttribute('transform', `scale(${scale + 0.5})`);
        }

        function startCycleShapes() {
            const songData = songConfig[songSelect.value];
            let totalTime = 0;

            songData.shapeOrder.forEach((shape, index) => {
                setTimeout(() => {
                    currentShapeIndex = index;
                    updateShapeVisibility();
                }, totalTime);
                totalTime += songData.durations[index];
            });

            cycleInterval = setInterval(() => {
                currentShapeIndex = (currentShapeIndex + 1) % songData.shapeOrder.length;
                updateShapeVisibility();
            }, totalTime);
        }

        function resetVisualizer() {
            clearInterval(cycleInterval);
            audioPlayer.currentTime = 0;
            audioPlayer.pause();
            updateShapeVisibility();
        }

        function getCurrentShape() {
            return songConfig[songSelect.value].shapeOrder[currentShapeIndex];
        }

        function updateShapeVisibility() {
            Object.keys(shapes).forEach(key => {
                shapes[key].style.display = key === getCurrentShape() ? 'block' : 'none';
            });
        }
    </script>
</body>
</html>
